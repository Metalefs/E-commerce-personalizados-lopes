<ng-container
  *ngIf="MostarOpcoes; then Padrao; else Minimalista"
></ng-container>

<ng-template #Padrao>
  <ng-container *ngIf="TrocaImagem; then troca; else naotroca"> </ng-container>

  <ng-template #troca>
    <div matRipple
         class="card portfolio-item zoom of-y-scroll card"
         [style.flexDirection]="flex_direction">
         <div
          [ngClass]="{'pos-absolute':flex_direction == false}"
          class='card-title top-0 left-0 w-full'>

          <div class="content w-full of-x-scroll px-3">
            <a
              matRipple
              class="reset-a titulo-produto"
              pageScroll
              href="#topo"
              (click)="AbrirPaginaProduto()"
            >
              {{ Produto?.Nome }}
            </a>
          </div>
        </div>
      <div class="card-image has-background-white">
        <slideshow
          style="min-height: 300px !important;"
          *ngIf="imageUrls.length"
          [imageUrls]="imageUrls"
          [arrowSize]="(Carrosel$ | async)?.arrowSize"
          [showArrows]="false"
          [disableSwiping]="false"
          [autoPlay]="false"
          [backgroundSize]="'contain'"
          [backgroundPosition]="(Carrosel$ | async)?.backgroundPosition"
          [backgroundRepeat]="(Carrosel$ | async)?.backgroundRepeat"
          [showDots]="(Carrosel$ | async)?.showDots"
          [dotColor]="'black'"
          [showCaptions]="(Carrosel$ | async)?.showCaptions"
          [captionColor]="(Carrosel$ | async)?.captionColor"
          [captionBackground]="(Carrosel$ | async)?.captionBackground"
          [lazyLoad]="true"
          [hideOnNoSlides]="(Carrosel$ | async)?.hideOnNoSlides"
          [fullscreen]="(Carrosel$ | async)?.fullscreen"
          [autoPlayWaitForLazyLoad]="true">
        </slideshow>
        <figure class="image is-128x128 is-hidden-touch"></figure>
        <figure class="image is-64x64 is-hidden-tablet"></figure>
        <personalizados-lopes-card-produto-status-produto [Produto]='Produto' [statusProduto]='statusProduto'
                                                          [Produto.Status.toString().toLowerCase]='Produto.Status.toString().toLowerCase'
                                                          [translateStatusProduto]='translateStatusProduto'></personalizados-lopes-card-produto-status-produto>
        <div class="pos-absolute z-index-top top-0 right-0">
          <div>
            <personalizados-lopes-card-produto-btn-abrir-modal
              [AbrirPreviewProduto]='AbrirPreviewProduto'></personalizados-lopes-card-produto-btn-abrir-modal>
          </div>

          <div>
            <personalizados-lopes-card-produto-btn-favoritar
            [AdicionarFavorito]='AdicionarFavorito'
            [Favorito]="Favorito"></personalizados-lopes-card-produto-btn-favoritar>
          </div>

          <div>
              <personalizados-lopes-card-produto-btn-comparar
              [AdicionarComparacao]='AdicionarComparacao'></personalizados-lopes-card-produto-btn-comparar>

          </div>

        </div>
      </div>

      <div class="card-content">
        <div class='content'>

          <div class="my-0">
            <star-rating
              [rating]="meanRating()"
              [hoverEnabled]="true"
              [readOnly]="true"
              [showHalfStars]="true"
              [step]="0.5"
              staticColor="ok"
              [starType]="'svg'"
            ></star-rating>
          </div>
          <div class='card-subtitle'>
            {{ Produto?.Subtitulo }}
          </div>
          <a
            *ngIf="Produto.Status == statusProduto.esgotado"
            (click)="AbrirPaginaProduto()"
            routerLinkActive="router-link-active"
            class="wp-btn button border is-rounded is-small py-3 box"
            style="text-decoration: none;"
          >
            Esgotado
          </a>

          <div class="hover-text">
            <a
              title="Comprar"
              matRipple
              pageScroll
              href="#topo"
              class="button shadow-light hoverable"
              style="top: 37%; left: 27%;"
              (click)="AbrirPaginaProduto()"
              mat-flat-button
              ><mat-icon class="material-icons-outlined"
                >shopping_bag</mat-icon
              ></a
            >
            <div
              class="content m-lr-auto flex-c-m dis-flex"
              [style.width]="flex_direction == 'row' ? '45%' : '100%'"
              [style.left]="'8%'"
            >
              <div class="portfolio-overlay events-none w-full" style="top: 10px;">
                <div class="overlay-items w-full txt-center">
                  <p>
                    {{
                    Produto?.DescricaoRapida
                      ? Produto?.DescricaoRapida
                      : Produto?.Nome
                    }}
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <footer class='card-footer dis-flex flex-m flex-sb px-3'>
        <personalizados-lopes-card-produto-btn-comprar
          [AbrirPaginaProduto]='AbrirPaginaProduto'></personalizados-lopes-card-produto-btn-comprar>
        <div class="">
          <p class="preco preto6">
            R$ {{ Produto?.Preco.toFixed(2) || '0.00' }}
          </p>
        </div>
      </footer>
      <figure
        class="image is-64x64 img-orcamento"
        [ngClass]="isOrcamento ? 'active' : ''"
      >
        <img src="{{ (Produto?.Imagem)[0] }}" alt="" />
      </figure>
    </div>

  </ng-template>

  <ng-template #naotroca>
    <mat-card
      @fadeIn
      (mouseenter)="
        this.imgProduto.classList.add('hide');
        this.imgProduto.classList.remove('show')
      "
      (mouseout)="
        this.imgProduto.classList.remove('hide');
        this.imgProduto.classList.add('show')
      "
      matRipple
      style="height: 100%;"
      class="portfolio-item of-y-scroll z-index-top card"
      [style.backgroundColor]="Produto.Categoria.Cor"
      [style.flexDirection]="flex_direction"
    >
      <div #imgProduto matRipple class="dis-flex flex-w w-full">
        <slideshow
          mat-card-image
          *ngIf="imageUrls.length"
          [imageUrls]="imageUrls"
          [arrowSize]="(Carrosel$ | async)?.arrowSize"
          [showArrows]="false"
          [disableSwiping]="false"
          [backgroundSize]="'contain'"
          [autoPlay]="false"
          [backgroundPosition]="(Carrosel$ | async)?.backgroundPosition"
          [backgroundRepeat]="(Carrosel$ | async)?.backgroundRepeat"
          [showDots]="(Carrosel$ | async)?.showDots"
          [dotColor]="'black'"
          [showCaptions]="(Carrosel$ | async)?.showCaptions"
          [captionColor]="(Carrosel$ | async)?.captionColor"
          [captionBackground]="(Carrosel$ | async)?.captionBackground"
          [lazyLoad]="(Carrosel$ | async)?.lazyLoad"
          [hideOnNoSlides]="(Carrosel$ | async)?.hideOnNoSlides"
          [fullscreen]="(Carrosel$ | async)?.fullscreen"
          [autoPlayWaitForLazyLoad]="true"
        >
        </slideshow>
      </div>
      <div class="pos-absolute z-index-1 top-0 right-0">
        <button
          title="Mais informações"
          matRipple
          pageScroll
          href="#topo"
          class="button is-small shadow-light hoverable m-lr-auto px-4"
          [style.top]="flex_direction == 'row' ? '45%' : '35%'"
          [style.width]="flex_direction == 'row' ? '45%' : '45%'"
          (click)="AbrirPreviewProduto()"
          class=""
        >
          <i class="pi pi-window-maximize"></i>
        </button>
      </div>
      <mat-card-title class="fs-16 w-full mb-0 txt-center pt-1">
        <a matRipple class="titulo-produto has-text-black reset-a" (click)="AbrirPaginaProduto()">
          {{ Produto?.Nome }}
        </a>
        <div class="my-0">
          <star-rating
            [rating]="meanRating()"
            [hoverEnabled]="true"
            [readOnly]="true"
            [showHalfStars]="true"
            [step]="0.5"
            staticColor="ok"
            [starType]="'svg'"
          ></star-rating>
        </div>
      </mat-card-title>
      <mat-card-actions class="px-2 z-index-2">
        <a
        matRipple
        class="dis-flex flex-w w-full pos-absolute top-0 left-0"
        [href]="'/produtos/' + Produto._id"
      >
        <span class="prod-status">
          <i class="pi pi-tag product-category-icon"></i>
          <span class="product-category"></span>
          <span
            [class]="
              'subtitle is-size-7 is-capitalized product-badge status-' +
              Produto.Status.toString().toLowerCase()
            "
          >
            Em {{ Produto.Cores?.length }} cores</span
          >
        </span>
      </a>
        <mat-card-actions
          class="w-full columns is-mobile"
        >
          <div class="column is-7">
            <ng-container
              *ngIf="
                Produto?.Status == statusProduto.promocao;
                then preco_promo;
                else preco_normal
              "
            >
            </ng-container>
            <ng-template #preco_promo>
              <div class="w-full" *ngIf="Produto?.Parcelas == 0">
                <p class="is-size-7 linethr">
                  <span class="is-size-7 preto6">de</span> R$
                  {{ Produto?.Preco.toFixed(2) || '0.00' }}
                </p>
                <p class="preco promocao preto6">
                  <span class="is-size-7">Por</span> R$
                  {{ Produto?.PrecoPromocional.toFixed(2) || '0.00' }}
                </p>
              </div>
            </ng-template>
            <ng-template #preco_normal>
              <div class="w-full" *ngIf="Produto?.Parcelas == 0">
                <p class="preco preto6">
                  R$ {{ Produto?.Preco.toFixed(2) || '0.00' }}
                </p>
              </div>
            </ng-template>
            <div class="my-0" *ngIf="Produto.Parcelas && Produto.Parcelas >= 0">
              <p class="parcelas" *ngIf="Produto.Parcelas > 1">
                Em até {{ Produto.Parcelas }}x de
                <span class="parcelas">
                  <b
                    >R${{
                      (Produto.Status == statusProduto.promocao
                        ? Produto.PrecoPromocional
                        : Produto.Preco / Produto.Parcelas
                      ).toFixed(2)
                    }}</b
                  ></span
                >
                sem juros
              </p>
              <p class="parcelas" *ngIf="Produto.Parcelas == 1">
                <span class="parcelas">
                  Á vista por
                  <b
                    >R${{
                      (Produto.Status == statusProduto.promocao
                        ? Produto.PrecoPromocional
                        : Produto.Preco / Produto.Parcelas
                      ).toFixed(2)
                    }}</b
                  >
                  sem juros</span
                >
              </p>
            </div>
            <div class='card-subtitle fw-600'>
              {{ Produto?.Subtitulo }}
            </div>
          </div>
          <div class="column">
            <button
            href="javascript:void(0)"
            class="button is-outlined w-full is-info is-rounded top-0 left-0"
            (click)="AdicionarAoOrcamento()"
          >
            <span class="is-fullwidth">
              <span><mat-icon class="">add_shopping_cart</mat-icon> </span>
            </span>
          </button>
          </div>
        </mat-card-actions>

        <div class="z-index-1">
          <div class="content a-i-c m-lr-auto w-full">
            <div
              class="portfolio-overlay events-none w-full"
              style="top: 10px; left: 0px;"
              [style.width]="flex_direction == 'row' ? '50%' : '100%'"
            >
              <div class="overlay-items w-full txt-center">
                <p>
                  {{
                    Produto?.DescricaoRapida
                      ? Produto?.DescricaoRapida
                      : Produto?.Nome
                  }}
                </p>
              </div>
            </div>
            <a
              title="Comprar"
              matRipple
              pageScroll
              href="#topo"
              class="reset-a button shadow-light hoverable is-success m-lr-auto"
              style="top: 37%; left: 27%;"
              (click)="AbrirPaginaProduto()"
              mat-flat-button
              class=""
              ><mat-icon class="material-icons-outlined"
                >shopping_bag</mat-icon
              ></a
            >
          </div>
        </div>
      </mat-card-actions>
    </mat-card>
    <figure
      class="image is-64x64 img-orcamento"
      [ngClass]="isOrcamento ? 'active' : ''"
    >
      <img src="{{ (Produto?.Imagem)[0] }}" alt="" />
    </figure>
  </ng-template>
</ng-template>

<ng-template #Minimalista>
  <mat-card
    data-aos="flip-down"
    class="flex-w flex-c portfolio-item zoom mat-elevation-z4"
  >
    <a pageScroll href="#PRODUTO" (click)="AbrirPaginaProduto()">
      <img
        src="{{ (Produto?.Imagem)[0] }}"
        alt="Foto de {{ Produto?.NomeCategoria }} {{ Produto?.Cor }} - {{
          Produto?.Nome
        }}"
      />
      <mat-card-content class="flex-w flex-c">
        <div class="portfolio-overlay w-full">
          <div class="overlay-items w-full flex-w flex-c">
            <p>
              {{ Produto?.Nome }}
            </p>
          </div>
        </div>
      </mat-card-content>
    </a>
  </mat-card>
</ng-template>
