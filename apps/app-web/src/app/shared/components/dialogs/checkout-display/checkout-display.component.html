<p>
  <mat-toolbar color="primary" class="pri-toolbar">
    <mat-toolbar-row class="pt-3">
      <span>Carrinho</span>
      <span class="spacer"></span>

      <button mat-icon-button
      aria-label="fechar carrinho"
      (click)="close()">
        <mat-icon>close</mat-icon>
      </button>
    </mat-toolbar-row>
  </mat-toolbar>
</p>

<ng-container *ngIf="(Orcamento$ |async).Produto.length > 0 then pedido else vazio"></ng-container>

<ng-template #vazio>

  <div @fadeIn class="px-3">
    <div class=" w-full">
      <figure class="image is-square">
        <img src="/assets/images/figures/undraw_empty_cart_co35.svg">

      </figure>
    </div>
    <div class="has-text-left">
      <h2 class="subtitle mb-0 pt-0">Seu carrinho está vazio</h2>
      <span class="subtitle">Clique abaixo para voltar e adicionar produtos ao seu orçamento</span>
    </div>
    <div class="a-i-c pt-3">

      <a
      pageScroll
      href="#topo"
      (pageScrollFinish)="close()"
      [routerLink]="['/produtos/']"
      routerLinkActive="router-link-active">
        <button mat-stroked-button mat-stroked-button class="button is-dark">
          Ver produtos
          <mat-icon>keyboard_arrow_right</mat-icon>
        </button>
      </a>

    </div>
  </div>

</ng-template>
<ng-template #pedido>

  <section class="section py-0" data-aos="slide-left">
    <div class="has-text-left">
      <h2 class="subtitle">Confira o seu pedido</h2>
      <span class="subtitle">Revise seus produtos e continue para inserir seus dados pessoais.</span>
    </div>
    <div class="a-i-c  py-2">

      <div class="box w-full">

        <table mat-table [dataSource]="ProdutoTable.dataSource" class="w-full">

          <ng-container matColumnDef="Produtos">
            <th mat-header-cell *matHeaderCellDef> Produtos </th>
            <td @fadeIn mat-cell *matCellDef="let element">
              <div @fadeIn class="columns a-i-c mt-3">
                <div class="column flex-m">
                  <figure class="image is-64x64">
                    <img src="{{element.Imagem[0]}}">
                  </figure>
                  <a href="#topo"
                  (click)="close()"
                   [routerLink]="['/produtos/',element._id]"
                   routerLinkActive="router-link-active"
                    class="px-3 titulo-produto is-hidden-desktop">{{element.Nome}}
                    <p class="subtitle">{{element.Cor.nome}}</p>
                    <p class="subtitle">{{element.Tamanho}}</p>
                  </a>
                </div>
                <div class="column ">
                  <a href="#topo" [routerLink]="['/produtos/',element._id]" routerLinkActive="router-link-active"
                    class="titulo-produto is-hidden-touch">{{element.Nome}}
                    <p class="subtitle">{{element.Cor.nome}}</p>
                    <p class="subtitle">{{element.Tamanho}}</p>
                  </a>

                  <button (click)="removerProduto(element)">
                    remover
                  </button>
                </div>
              </div>
              <div class="columns is-mobile is-hidden-desktop mb-2">
                <div class="column is-9">
                  <div class="control is-small">
                    <button mat-icon-button (click)="DecrescerQuantidade(element)">
                      <mat-icon class="less">remove</mat-icon>
                    </button>
                    <input placeholder="{{element?.QuantidadeMinima}}" value="{{element?.QuantidadeMinima}}"
                      type="number" (change)="VerificarQuantidade($event,element)" min="{{element?.QuantidadeMinima}}"
                      class="quantidade-produto is-rounded" [(ngModel)]="(element).Quantidade">
                    <button mat-icon-button (click)="IncrementarQuantidade(element)">
                      <mat-icon class="more">add</mat-icon>
                    </button>
                  </div>
                </div>
                <div class="column">
                  <span class="preco">R$ {{CalcularPreco(element)}}</span>
                </div>
              </div>
            </td>
          </ng-container>

          <ng-container matColumnDef="Quantidade" class="is-hidden-touch">
            <th mat-header-cell *matHeaderCellDef class="is-hidden-touch"> qtd </th>
            <td @fadeIn mat-cell *matCellDef="let element" class="is-hidden-touch">
              <div class="control is-small ">
                <button mat-icon-button (click)="DecrescerQuantidade(element)">
                  <mat-icon class="less">remove</mat-icon>
                </button>
                <input placeholder="{{element?.QuantidadeMinima}}" value="{{element?.QuantidadeMinima}}" type="number"
                  (change)="VerificarQuantidade($event,element)" min="{{element?.QuantidadeMinima}}"
                  class="quantidade-produto is-rounded" [(ngModel)]="(element).Quantidade">
                <button mat-icon-button (click)="IncrementarQuantidade(element)">
                  <mat-icon class="more">add</mat-icon>
                </button>
              </div>
            </td>
          </ng-container>

          <ng-container matColumnDef="Subtotal" class="is-hidden-touch">
            <th mat-header-cell *matHeaderCellDef class="is-hidden-touch"> Subtotal</th>
            <td mat-cell *matCellDef="let element" class="is-hidden-touch">
              <span class="preco">R$ <span>{{CalcularPreco(element)}}</span></span>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="ProdutoTable.displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: ProdutoTable.displayedColumns;"></tr>
        </table>
          <div class="w-full">
            <a
              (click)="delayClose()"
              [routerLink]="['/checkout/dados/']" pageScroll href="#TOPO" routerLinkActive="router-link-active"
              class="button is-success w-full"><span class="nunitoParagraphy16 has-text-white">Finalizar
                orçamento</span></a>
            <button class="py-3 pb-3  w-full">
              <a href="#topo" class="py-3" [routerLink]="['/produtos/']" routerLinkActive="router-link-active">Escolher
                mais
                produtos</a>
            </button>
          </div>
      </div>

    </div>

  </section>
  <mat-toolbar class="w-full pt-3 pos-sticky bottom-0">
      <mat-toolbar-row>
        <div class="columns">
          <div class="column"></div>
          <div class="column"></div>
          <div class="column has-text-right">
            <p class="titulo-produto">Total: <span class="preco">R${{Total}}</span></p>
          </div>
        </div>
      </mat-toolbar-row>
    </mat-toolbar>
</ng-template>
