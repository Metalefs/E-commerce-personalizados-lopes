<div class="sticky-nav py-4 border shadow-light"
  class="{{(NavState$ |async).activeNav.toLocaleLowerCase() == 'contato' ? 'orcamento-nav': ''}}"
  [ngClass]="(NavState$ |async).activeNav.toLocaleLowerCase() == 'básicos' ? 'produtos-nav': ''"
>
  <!-- container -->
  <mat-toolbar
  class="mat-toolbar pos-sticky mr-0 dis-flex flex-c w-full">
  <div class="w-full margin dis-flex flex-c flex-m flex-ba py-4 ml-1 mr-6 px-3" style="height: 90px;">

    <a @fadeIn href="#" class="">
      <img class=" pb-3" src="assets/images/icons/Logo-full.png" alt="LOGO">
    </a>
    <span class="spacer"></span>
    <div *ngIf="search" class="w-full columns is-mobile is-multiline is-vcentered mx-3 w-full animate__animated animate__slideInLeft">
      <div class="column is-12-mobile animate__animated animate__slideInLeft">
        <div class="control has-icons-right animate__animated animate__slideInLeft">
          <form type="get" action="/produtos/?nome={{search_filter}}" *ngIf="(Produto$|async)?.length>0">
              <personalizados-lopes-autocomplete-dropdown
               (VerTodosResultados)="executar_pesquisa()"
               class="w-full" (SearchValueChanged)="handleSearchValue($event)"></personalizados-lopes-autocomplete-dropdown>
              <!-- <button [routerLink]="['/produtos']" [queryParams]="{nome:search_filter}" class="ml-6 s-button z-top">
                <mat-icon>search</mat-icon>
              </button> -->
          </form>
        </div>
      </div>
    </div>
    <div class="ml-1">
    </div>
    <div class="columns mx-3 is-hidden-touch link-section ">

      <div class="column is-1">
        <span class="icon pt-2 is-small hoverable clickable" (click)="search = !search">
          <mat-icon matSuffix>{{search ? 'close' : 'search'}}</mat-icon>
        </span>
      </div>
      <div *ngFor="let link of links" class="column">

        <ng-container *ngIf="link.options then dropdown else normal"></ng-container>

        <ng-template #normal>
          <a
            (click)="SetActiveNav(link)"
            [ngClass]="(NavState$ |async).activeNav == link.name ? 'active-nav': ''"
            class="nav-link hoverable {{link.name == 'inicio' ? 'inicio': ''}}"
            pageScroll
            [routerLink]="link.href"
            routerLinkActive="Active"
            href="#{{link.name == 'Básicos' ? 'topo' : link.name}}">
            <mat-icon *ngIf="link.icon">{{link.icon}}</mat-icon>
            {{link.name == "Básicos"? 'Produtos' : link.name}}
          </a>
        </ng-template>

        <ng-template #dropdown>
          <div class="dropdown">
            <a (click)="SetActiveNav(link)"
              [routerLink]="link.href"
              pageScroll
              routerLinkActive="Active"
              [ngClass]="(NavState$ |async).activeNav == link.name ? 'active-nav': ''"
              class="nav-link hoverable {{link.name == 'inicio' ? 'inicio': ''}}">
              <mat-icon *ngIf="link.icon">{{link.icon}}</mat-icon>
              {{link.name == "Básicos"? 'Produtos' : link.name}}
            </a>
            <div class="dropdown-content">
              <a
              class="nav-link hoverable {{link.name == 'inicio' ? 'inicio': ''}}"
              pageScroll
              routerLinkActive="Active"
              href="#{{link.name == 'Básicos' ? 'topo' : link.name}}"
              [routerLink]="opt.link"
              [queryParams]="opt.queryParams"
              *ngFor="let opt of link.options">{{opt.nome}}</a>
            </div>
          </div>
        </ng-template>

      </div>
    </div>

    <div class="pb-4 dis-flex flex-m">

      <div class="dropdown mr-4 is-hidden-touch">
        <a class="wrap-pic-cir border w-full mb-4"
          mat-icon-button
          title="Perfil">
          <mat-icon>person_outline</mat-icon>
        </a>
        <div class="dropdown-content right-0">
          <a mat-menu-item *ngIf="!user" (click)="openLogin()">Login</a>
          <a mat-menu-item *ngIf="user" [routerLink]="['/minha-conta/perfil']">Meu Perfil</a>
          <a mat-menu-item *ngIf="user && user?.Tipo == TipoUsuario.admin" [routerLink]="['/gerenciamento']">Gerenciamento</a>
          <a mat-menu-item *ngIf="user" (click)="Logout()">Sair</a>
        </div>
      </div>
      <div class="pb-4 is-hidden-desktop ml-4">
       <button mat-mini-fab data-aos="fade-up" (click)="openCheckout()"
          title="Checkout"
          aria-label="Botão abrir Orçamento"
          color="accent"
          class="size4 flex-c-m how-social border shadow-light orcamento trans-04 m-b-3 m-t-3">
          <div class="columns line-height-small is-mobile">

          </div>
          <div class="columns">
            <div class="column">
              <mat-icon class="material-icons-outlined">shopping_bag</mat-icon>
              <p class="cart-counter">{{(Orcamento$|async).Produto.length || 0}}</p>
            </div>
          </div>
        </button>
      </div>
      <div class="is-hidden-touch">
        <button mat-mini-fab data-aos="fade-up" (click)="openCheckout()"
            title="Checkout"
            aria-label="Botão abrir Orçamento"
            color="accent"
            class="size4 flex-c-m how-social shadow-light orcamento trans-04 m-b-3 m-t-3">
            <!-- <p class="cart-subtitle" *ngIf="(Orcamento$|async)?.Produto.length > 0">{{(Orcamento$|async)?.Produto.length}} item(s) no carrinho</p>
              <p class="cart-subtitle" *ngIf="(Orcamento$|async)?.Produto.length == 0">carrinho vazio</p> -->
              <div class="columns is-mobile is-vcentered">
                <div class="column">
                  <mat-icon class="material-icons-outlined pl-2">shopping_bag</mat-icon>
                  <p class="cart-counter">{{(Orcamento$|async).Produto.length || 0}}</p>
                </div>
                <div class="column is-hidden-touch">
                  <p class="preco" *ngIf="(Orcamento$|async).Preco">
                    R${{(Orcamento$|async).Preco.toFixed(2) || ''}}
                  </p>
                </div>
              </div>
          </button>
      </div>
    </div>
  </div>
</mat-toolbar>

<mat-toolbar-row
  [ngClass]="(NavState$ |async).activeNav.toLocaleLowerCase() == 'básicos' ? 'produtos-nav-under': 'is-hidden'">
</mat-toolbar-row>

</div>
