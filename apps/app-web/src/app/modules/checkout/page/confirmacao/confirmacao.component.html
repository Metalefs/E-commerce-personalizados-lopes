<ng-container *ngIf="(Orcamento$ |async).Produto.length > 0 then pedido else vazio"></ng-container>
<ng-template #vazio>

  <div class=" w-full">
    <figure class="image is-square">
      <img src="/assets/images/figures/undraw_empty_cart_co35.svg">

    </figure>
  </div>
  <div class="has-text-left">
    <h2 class="subtitle mb-0 pt-0">Seu carrinho está vazio</h2>
    <span class="subtitle">Clique abaixo para voltar e adicionar produtos ao seu orçamento</span>
  </div>
  <div class="a-i-c pt-3">

    <a pageScroll
    href="#TOPO"
    [routerLink]="['/produtos/']"
    routerLinkActive="router-link-active">
    <button mat-stroked-button mat-stroked-button class="button is-dark">
      Ver produtos
      <mat-icon>keyboard_arrow_right</mat-icon>
    </button>
  </a>

</div>

</ng-template>
<ng-template #pedido>

<section @fadeIn class="section py-0 px-0">
  <div *ngIf="edit" class="has-text-left">
    <h2 class="subtitle">Confira o seu pedido</h2>
    <span class="subtitle">Revise seus produtos e continue para inserir seus dados pessoais.</span>
  </div>
  <div class="a-i-c">

    <div class="box border w-full px-2">

      <table mat-table [dataSource]="ProdutoTable.dataSource" class="w-full" >

        <ng-container matColumnDef="Produtos">
          <th mat-header-cell *matHeaderCellDef> Produtos </th>
          <td @fadeIn mat-cell *matCellDef="let element">
            <div @fadeIn class="columns a-i-c mt-3">
              <div class="column flex-m" >
                <figure class="image is-64x64">
                  <img src="{{element.Produto.Imagem[0]}}">
                </figure>
                <figure class="image is-64x64 d-block ">
                  <img *ngIf="element.Produto.Arte" src="{{element.Produto.Arte || ''}}">
                  <div *ngIf="!element.Produto.Arte" class="px-2 txt-center ">
                    <em>Sem Arte</em>
                    <button mat-flat-button class="button file is-info has-name pb-3 px-0">
                      <label class="file-label">
                        <input class="file-input" multiple type="file" (change)="upload($event,element)">
                        <span class="file-cta">
                          <span class="file-icon">
                           <mat-icon>file_upload</mat-icon>
                          </span>
                        </span>
                      </label>
                    </button>
                  </div>
                </figure>
                <a
                href="#topo"
                [routerLink]="['/produtos/'+element.Produto._id+'/'+element.codOrcamento]"
                routerLinkActive="router-link-active"
                class="px-3 titulo-produto is-hidden-desktop"
                >{{element.Produto.Nome}}
                <p class="subtitle">{{element.Produto.Cor?.nome}}</p>
                <p class="subtitle">{{element.Produto?.Tamanho}}</p>
              </a>
              </div>
              <div class="column ">
                <a
                href="#topo"
                [routerLink]="['/produtos/'+element.Produto._id+'/'+element.codOrcamento]"
                routerLinkActive="router-link-active"
                class="titulo-produto is-hidden-touch"
                >{{element.Produto.Nome}}
                <p class="subtitle">{{element.Produto.Cor?.nome}}</p>
                <p class="subtitle">{{element.Produto?.Tamanho}}</p>
              </a>

                <button *ngIf="edit" (click)="removerProduto(element)">
                  remover
                </button>
              </div>
            </div>
            <div class="columns is-mobile is-hidden-desktop mb-2">
              <div class="column is-9">
                <div class="control is-small">
                  <button *ngIf="edit" mat-icon-button (click)="DecrescerQuantidade(element)">
                    <mat-icon class="less" >remove</mat-icon>
                  </button>
                  <input
                    placeholder="{{element?.Produto.QuantidadeMinima}}"
                    value="{{element?.Produto.QuantidadeMinima}}"
                    type="number"
                    (change)="VerificarQuantidade($event,element)"
                    min="{{element?.Produto.QuantidadeMinima}}"
                    class="quantidade-produto is-rounded"
                    [(ngModel)]="(element).Produto.Quantidade">
                  <button *ngIf="edit" mat-icon-button (click)="IncrementarQuantidade(element)">
                    <mat-icon class="more" >add</mat-icon>
                  </button>
                </div>
              </div>
              <div class="column">
                <span class="preco">R$ {{CalcularPreco(element)}}</span>
              </div>
            </div>
          </td>
        </ng-container>

        <ng-container matColumnDef="Quantidade" class="is-hidden-touch">
          <th mat-header-cell *matHeaderCellDef  class="is-hidden-touch"> qtd </th>
          <td @fadeIn mat-cell *matCellDef="let element"  class="is-hidden-touch">
            <div class="control is-small ">
              <button *ngIf="edit" mat-icon-button (click)="DecrescerQuantidade(element)">
                <mat-icon class="less" >remove</mat-icon>
              </button>
              <input
                placeholder="{{element?.Produto.QuantidadeMinima}}"
                value="{{element?.Produto.QuantidadeMinima}}"
                type="number"
                (change)="VerificarQuantidade($event,element)"
                min="{{element?.Produto.QuantidadeMinima}}"
                class="quantidade-produto is-rounded"
                [(ngModel)]="(element).Produto.Quantidade">
              <button *ngIf="edit" mat-icon-button (click)="IncrementarQuantidade(element)">
                <mat-icon class="more" >add</mat-icon>
              </button>
            </div>
          </td>
        </ng-container>

        <ng-container matColumnDef="Subtotal" class="is-hidden-touch">
          <th mat-header-cell *matHeaderCellDef  class="is-hidden-touch"> Subtotal</th>
          <td mat-cell *matCellDef="let element"  class="is-hidden-touch">
          <span  class="preco">R$ <span>{{CalcularPreco(element)}}</span></span>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="ProdutoTable.displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: ProdutoTable.displayedColumns;"></tr>
      </table>
      <div class="w-full pt-3">
        <div class="columns">
          <div class="column"></div>
          <div class="column"></div>
          <div class="column has-text-right">
            <p class="titulo-produto">Total: <span class="preco">R${{(Orcamento$|async).Preco}}</span></p>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="edit" class="w-full">
        <button
          class="py-3 pb-3  w-full"
        >
        <a href="#topo"
        class="py-3"
        [routerLink]="['/produtos/']"
        routerLinkActive="router-link-active">Escolher mais produtos</a>
      </button>
      <button  [routerLink]="['/checkout/dados/']"
        pageScroll
        href="#TOPO"
        routerLinkActive="router-link-active"
        class="button is-success w-full">Finalizar orçamento</button>
    </div>
  </div>

</section>
</ng-template>
