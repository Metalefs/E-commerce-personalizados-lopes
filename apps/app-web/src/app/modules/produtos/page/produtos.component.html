<div class="section mb-0" id="PRODUTOS">

  <div class="columns px-3">
    <div class="column is-12-mobile">
      <div class="flex-c w-full container portfolio pos-sticky top-0">
        <div>
          <h2 class="title is-5">Categorias</h2>
          <nav class="categories is-hidden-mobile">
            <ul class="portfolio-filter flex-w flex-c">
              <mat-chip-list aria-label="Categoria selection">
                <mat-chip
                 pageScroll
                 href="#PRODUTOS"
                 class="pointer w-full"
                 (click)="SetCategoria(null)"
                 [ngClass]="CategoriaAtiva?.Nome == defaultCategory ? 'active' : ''">
                  todos os produtos
                  <mat-icon>{{CategoriaAtiva?.Nome == defaultCategory ? 'done' : ''}}</mat-icon>
                </mat-chip>
                <mat-chip
                    *ngFor="let categoria of Categorias$ | async"
                    [style.backgroundColor]="categoria?.Cor"
                    class="pointer w-full"
                    (click)="SetCategoria(categoria)"
                    [ngClass]="CategoriaAtiva?.Nome == categoria.Nome ? 'active' : ''">
                    {{categoria?.Nome}}
                    <mat-icon>{{CategoriaAtiva?.Nome == categoria.Nome ?  'done' : ''}}</mat-icon>
                </mat-chip>
              </mat-chip-list>
            </ul>
          </nav>
        </div>
      </div>
    </div>
    <div class="column is-9 is-12-mobile produto-column">
      <div class="pb-6">
        <div class="columns is-multiline portfolio-container">

          <nav class="categories is-hidden-desktop has-background-white">

            <ul class="portfolio-filter flex-w flex-c">
              <mat-chip-list aria-label="Categoria selection">

                <mat-chip class="pointer"
                  href="#PRODUTOS"
                  (click)="SetCategoria(null)"
                  [ngClass]="CategoriaAtiva?.Nome == defaultCategory ? 'active' : ''"
                  class="w-full"
                  >
                  Todos os produtos
                  <mat-icon>{{CategoriaAtiva?.Nome == defaultCategory ? 'done' : ''}}</mat-icon>
                </mat-chip>

                <mat-chip *ngFor="let categoria of Categorias$ | async"
                    class="pointer"
                    pageScroll
                    href="#TOPO"
                    [style.borderBottom]="'1px solid '+categoria?.Cor"
                    (click)="SetCategoria(categoria)"
                    [ngClass]="CategoriaAtiva?.Nome == categoria.Nome ? 'active' : ''"
                    class=""                    >
                    {{categoria?.Nome}}
                    <mat-icon>{{CategoriaAtiva?.Nome == categoria.Nome ?  'done' : ''}}</mat-icon>
                  </mat-chip>
              </mat-chip-list>
            </ul>

          </nav>

          <div class="w-full pt-3">
            <div class="columns is-mobile is-multiline px-2">
              <div class="column is-8">
                <div class="control has-icons-right">
                  <input
                    [(ngModel)]="activeSearchFilter"
                    (change)="atualizarFiltroAtivo()"
                    class="py-2 input"
                    type="text"
                    placeholder="filtrar produtos na categoria {{CategoriaAtiva?.Nome}}">
                    <span class="icon is-small is-right">
                      <mat-icon>search</mat-icon>
                    </span>
                </div>
              </div>
              <div class="column">
                <div class="select w-full">
                  <select class="py-2  w-full" [(ngModel)]="activeOrderFilter" (change)="atualizarFiltroAtivo()">
                    <option *ngFor="let order of ordertypes; let i = index" [selected]="i == 0" [value]="order.id">{{order.name}}</option>
                  </select>
                </div>
              </div>
            </div>
            <h2 class="title is-3 mx-5">{{CategoriaAtiva.Nome}}</h2>
          </div>

          <ng-container *ngFor="let produto of Produtos$ |async">
            <div @fadeIn
              class="column is-4"
              *ngIf="loading"
            >
              <mat-spinner></mat-spinner>

            </div>
            <div @fadeIn
              class="column is-4"
              *ngIf = "filtroAtivo(produto) && !loading">
              <personalizados-lopes-card-produto @fadeIn
                class=" portfolio-item"
                [Produto]="produto"
                [MostarOpcoes]="true"
              ></personalizados-lopes-card-produto>
            </div>
          </ng-container>
        </div>
      </div>
    </div>
  </div>
</div>
