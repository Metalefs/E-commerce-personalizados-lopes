<mat-toolbar class="py-4 mb-4 bbr w-full has-background-white is-hidden-tablet shadow-light pos-sticky top-0 z-index-top">
  <mat-toolbar-row class="py-1">
    <div class="columns is-gapless my-2 is-mobile w-full">
      <div class="column card has-background-white bo-0">
        <div mat-flat-button class="card pointer clickable txt-center a-i-c bo-0 w-full py-2 px-3"
          (click)="AbrirDialogoCategorias()">
          <p class=" is-size-5">Categoria</p>
          <span class="subtitle is-size-7"><em>({{CategoriaAtiva?.Nome}})</em></span>
          <!-- <mat-icon>category</mat-icon> -->
        </div>
      </div>
      <div class="column card has-background-white bo-0">
        <div mat-flat-button class="card pointer clickable txt-center a-i-c bo-0 w-full py-2 px-3"
          (click)="AbrirDialogoOrdenacao()">
          <p class=" is-size-5">Ordenação</p>
          <span class="subtitle is-size-7"><em>({{translate(activeOrderFilter)}})</em></span>
        </div>
      </div>
      <mat-divider></mat-divider>
    </div>
  </mat-toolbar-row>
</mat-toolbar>
<div class="has-background-white" style="border: 1px solid #e9ecef; border-width: 1px 0 1px 0;">

  <div [@cardFlip]="state" class="py-0 mb-0 pb-0 pt-0 pr-3" id="Todos">

    <div class="columns">
      <div class="column is-2 is-hidden-mobile">
        <div class="flex-c w-full portfolio pos-sticky pt-0">
          <div class="is-hidden-mobile w-full">
            <mat-list class="w-full pt-0">

              <!-- <h2 class="subtitle is-3 mb-5 is-hidden-mobile">{{CategoriaAtiva?.Nome}}</h2> -->

              <mat-toolbar>
                <div class="column is-12 w-full">
                  <span class="p-input-icon-left w-full ">
                    <i class="pi pi-search"></i>
                    <input type="text" class="border py-2" type="text" placeholder="{{CategoriaAtiva?.Nome}}"
                      pInputText [(ngModel)]="activeSearchFilter" matInput (change)="atualizarFiltroAtivo()"
                      placeholder="Search">
                  </span>
                </div>
              </mat-toolbar>
              <!-- <span class="subtitle is-size-7 w-full "> <b>{{(Filtro$|async)?.FiltroProdutos.length}}</b>
                    resultado{{(Filtro$|async)?.FiltroProdutos.length == 1 ? '':'s'}}</span> -->
              <mat-list-item @fadeIn class="pointer w-full w-full-m cat-item has-background-white-bis " (click)="SetCategoria(null)"
                [ngClass]="CategoriaAtiva?.Nome == defaultCategory ? 'active ' : ''">
                <a mat-strocked-button class="dis-flex flex-sb flex-m"
                  [ngClass]="CategoriaAtiva?.Nome == defaultCategory ? ' ' : 'has-text-grey'">
                  <button button class="border-0">
                    <mat-icon [ngClass]="CategoriaAtiva?.Nome == defaultCategory ?'has-text-success' :''">
                      {{CategoriaAtiva?.Nome == defaultCategory ? 'done' : ''}}
                    </mat-icon>
                  </button>
                  <p>{{defaultCategory}}</p>
                </a>
              </mat-list-item>
              <mat-list-item *ngFor="let categoria of (Categorias$ | async);let i = index"
                [style.backgroundColor]="categoria?.Cor"
                class="pointer w-full w-full-m cat-item has-background-white-bis " (click)="SetCategoria(categoria)"
                [ngClass]="CategoriaAtiva?.Nome == categoria?.Nome ? 'active  ' : 'has-text-grey'">
                <a [ngClass]="CategoriaAtiva?.Nome == categoria?.Nome ? ' ' : 'has-text-grey'" mat-strocked-button
                  class="dis-flex flex-sb flex-m ">
                  <button class="border-0">
                    <mat-icon [ngClass]="CategoriaAtiva?.Nome == categoria?.Nome ?'has-text-success' :''">
                      {{CategoriaAtiva?.Nome == categoria?.Nome ? 'done' : ''}}
                    </mat-icon>
                  </button>
                  <p class="">{{categoria?.Nome}}</p>
                </a>
              </mat-list-item>
            </mat-list>
            <hr>
            <div class="px-5">
              <div class="w-full is-hidden-mobile">
                <div class="w-full">
                  <div class="field">
                    <label class="label">Faixa de preço</label>
                    <div class="control">
                      <ngx-slider [(value)]="value" [(highValue)]="maxValue" [options]="options"
                        (userChange)="atualizarFiltroAtivo(false)"></ngx-slider>
                    </div>
                  </div>
                </div>
              </div>
              <mat-divider></mat-divider>
              <mat-form-field class="w-full" appearance="fill">
                <mat-label>Status</mat-label>
                <mat-select matNativeControl [(ngModel)]="activeOrderStatus" (selectionChange)="atualizarFiltroAtivo()">
                  <mat-option *ngFor="let opt of orderStatus" [value]="opt.id" class="w-full">
                    <div class="box w-full">
                      <p>{{opt.name}}</p>
                    </div>
                  </mat-option>
                </mat-select>
              </mat-form-field>
              <mat-list class="column">
                <mat-list-item>
                  <mat-checkbox matNativeControl [(ngModel)]="Parcelamento" (change)="atualizarFiltroAtivo()"
                    [checked]="false">
                    <label for="" class="label">Parcelamento</label>
                  </mat-checkbox>
                </mat-list-item>
                <mat-list-item>
                  <mat-checkbox matNativeControl [(ngModel)]="MultiplasCores" (change)="atualizarFiltroAtivo()"
                    [checked]="false">
                    <label for="" class="label">Multiplas Cores</label>
                  </mat-checkbox>
                </mat-list-item>
              </mat-list>
            </div>
          </div>
        </div>
      </div>
      <div class="column pl-0 is-10 is-12-mobile produto-column mh-full of-y-scroll-desktop of-y-scroll">
        <div class="pb-0 mb-0">
          <div class="w-full">

            <!-- <div *ngIf="total!=0" class="w-full dis-flex flex-sb is-hidden-mobile my-2">

              <p>Exibindo {{Produtos?.length}} de {{total}} {{total==1?' resultado':' produtos encontrados'}}</p>
              <span class="subtitle is-size-7">Página {{page}} de {{Ceil((total/activeOrderLimit))}}</span>


            </div> -->

            <div class="is-multiline dis-flex">

              <p-dataView [value]="Produtos" [lazy]="false" [paginator]="true" [rows]="12" totalRecords="{{total}}"
                pageLinkSize="3" paginatorPosition="bottom" [loading]="loading" class="w-full " [layout]="mobileQuery.matches ? 'list' : 'grid'"
                [emptyMessage]="'Nenhum item encontrado'">
                <ng-template pTemplate="header">
                  <div class="w-full columns flex-r dis-flex px-0 mx-0 flex-w is-vcentered is-mobile mb-0">

                        <div class="column is-hidden-tablet is-12-mobile">
                          <span class="p-input-icon-left w-full ">
                            <i class="pi pi-search"></i>
                            <input type="text" class="border py-2" type="text" placeholder="Filtrar em {{CategoriaAtiva?.Nome}}"
                              pInputText [(ngModel)]="activeSearchFilter" matInput (change)="atualizarFiltroAtivo()"
                              placeholder="Search">
                          </span>
                        </div>
                    <!-- <div class="column is-3-desktop is-6-mobile is-hidden-mobile">
                          <mat-form-field appearance="">
                            <mat-label>Página</mat-label>
                            <mat-select matNativeControl [(ngModel)]="activeOrderLimit" (selectionChange)="atualizarFiltroAtivo()">
                              <mat-option *ngFor="let opt of orderLimit" [value]="opt.id" class="w-full">
                                <div class="box w-full">
                                  <p>{{opt.name}}</p>
                                </div>
                              </mat-option>
                            </mat-select>
                          </mat-form-field>
                        </div> -->
                    <div class="column is-12-desktop is-4-mobile">

                      <div class="dis-flex w-full flex-r">
                        <p-dataViewLayoutOptions class="column is-hidden-touch"></p-dataViewLayoutOptions>
                        <mat-form-field appearance="" class="is-hidden-touch">
                          <mat-label>Ordenar por</mat-label>
                          <mat-select matNativeControl [(ngModel)]="activeOrderFilter"
                            (selectionChange)="atualizarFiltroAtivo()">
                            <mat-option *ngFor="let opt of ordertypes" [value]="opt.id" class="w-full">
                              <div class="box w-full">
                                <p>{{opt.name}}</p>
                              </div>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </div>
                    </div>
                  </div>


                </ng-template>
                <ng-template let-produto pTemplate="listItem">
                  <ng-container class="mx-0 px-0 ">
                    <div class="column is-12 pt-4" *ngIf="loading">
                      <div class="w-full mh-full skeleton">
                        <p-skeleton width="100%" height="100%">
                        </p-skeleton>
                      </div>
                    </div>
                    <div class="column is-12 pt-4" *ngIf="filtroAtivo(produto) && !loading">
                      <personalizados-lopes-card-produto @slideInOut [Produto]="produto" [MostarOpcoes]="true"
                        [flex_direction]="'row'"></personalizados-lopes-card-produto>
                    </div>
                  </ng-container>
                </ng-template>
                <ng-template let-produto pTemplate="gridItem">
                  <ng-container class="mx-0 px-0 ">
                    <div class="column is-3 pt-4 is-12-mobile" *ngIf="loading">
                      <div class="w-full mh-full skeleton">
                        <p-skeleton width="100%" height="100%">
                        </p-skeleton>
                      </div>
                    </div>
                    <div class="column is-4 is-12-mobile" *ngIf="filtroAtivo(produto) && !loading">
                      <personalizados-lopes-card-produto @slideInOut [Produto]="produto" [MostarOpcoes]="true">
                      </personalizados-lopes-card-produto>
                    </div>
                  </ng-container>
                </ng-template>
              </p-dataView>
              <p-skeleton *ngIf="total==0"></p-skeleton>

              <div class="w-full mh-full dis-flex flex-m m-lr-auto"
                *ngIf="(Filtro$ | async).FiltroProdutos.length == 0">

                <div @fadeIn class=" mh-full mb-5">
                  <figure class="no-match-img">
                    <img src="/assets/images/figures/undraw_empty_xct9.svg" class="no-match-img"
                      alt="Não foram encontrados produtos correspondentes à sua pesquisa">
                  </figure>
                  <p>Não foram encontrados produtos correspondentes à sua pesquisa</p>
                  <button md-mat-stroked-button color="primary" (click)="redefinirBusca()">Clique para redefinir a
                    busca</button>
                </div>
              </div>
            </div>
            <div class="w-full dis-flex flex-c-m">

              <div class="w-full is-hidden-desktop mb-3">
                <ngx-slider [(value)]="value" [(highValue)]="maxValue" [options]="options"
                  (userChange)="atualizarFiltroAtivo(false)"></ngx-slider>
              </div>
              <a [ngClass]="loading_more ? 'button is-loading':''" mat-fab title="Carregar mais produtos"
                class="px-3 w-full button wp-btn txt-center border-light" *ngIf="total > Produtos?.length"
                (click)="CarregarMaisProdutos()">
                <mat-icon>add</mat-icon>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>
